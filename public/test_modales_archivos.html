<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Modales con Archivos</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h2>Prueba de Funcionalidad de Archivos en Modales</h2>
    
    <div class="row">
        <div class="col-md-6">
            <button type="button" class="btn btn-warning btn-lg btn-block" data-toggle="modal" data-target="#modalIncidencias">
                <i class="fa fa-exclamation-triangle mr-2"></i>
                Probar Modal de Incidencias
            </button>
        </div>
        <div class="col-md-6">
            <button type="button" class="btn btn-info btn-lg btn-block" data-toggle="modal" data-target="#modalDevoluciones">
                <i class="fa fa-undo mr-2"></i>
                Probar Modal de Devoluciones
            </button>
        </div>
    </div>
    
    <div class="alert alert-info mt-4">
        <h5><i class="fa fa-info-circle mr-2"></i>Funcionalidades Implementadas:</h5>
        <ul class="mb-0">
            <li>✅ Campos de subida de archivos en ambos modales</li>
            <li>✅ Vista previa de archivos seleccionados</li>
            <li>✅ Validación de archivos (máximo 10MB)</li>
            <li>✅ Procesamiento de archivos en controladores</li>
            <li>✅ Almacenamiento en storage/app/public/</li>
            <li>✅ Integración con FormData para envío AJAX</li>
        </ul>
    </div>

    <div class="alert alert-warning mt-3">
        <h6><i class="fa fa-folder mr-2"></i>Ubicaciones de Almacenamiento:</h6>
        <ul class="mb-0">
            <li><strong>Incidencias:</strong> <code>storage/app/public/incidencias/</code></li>
            <li><strong>Devoluciones:</strong> <code>storage/app/public/devoluciones/</code></li>
        </ul>
    </div>
</div>

<!-- Los modales se cargarán desde el archivo principal -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
// Simulación básica de la funcionalidad de archivos
$(document).ready(function() {
    function mostrarArchivosSeleccionados(inputElement, listaElementId) {
        var archivos = inputElement.files;
        var listaContainer = document.getElementById(listaElementId);
        
        if (archivos.length === 0) {
            listaContainer.innerHTML = "";
            return;
        }

        var html = '<div class="alert alert-info"><strong>Archivos seleccionados:</strong><ul class="mb-0 mt-2">';
        
        for (var i = 0; i < archivos.length; i++) {
            var archivo = archivos[i];
            var tamaño = (archivo.size / (1024 * 1024)).toFixed(2);
            var iconoTipo = obtenerIconoArchivo(archivo.name);
            
            html += '<li class="mb-1">';
            html += '<i class="' + iconoTipo + ' mr-2"></i>';
            html += '<strong>' + archivo.name + '</strong> ';
            html += '<span class="badge badge-secondary">' + tamaño + ' MB</span>';
            html += '</li>';
        }
        
        html += '</ul></div>';
        listaContainer.innerHTML = html;
    }

    function obtenerIconoArchivo(nombreArchivo) {
        var extension = nombreArchivo.split('.').pop().toLowerCase();
        
        switch (extension) {
            case 'pdf':
                return 'fa fa-file-pdf text-danger';
            case 'doc':
            case 'docx':
                return 'fa fa-file-word text-primary';
            case 'xls':
            case 'xlsx':
                return 'fa fa-file-excel text-success';
            case 'jpg':
            case 'jpeg':
            case 'png':
            case 'gif':
                return 'fa fa-file-image text-info';
            default:
                return 'fa fa-file text-muted';
        }
    }

    console.log('Demo de funcionalidad de archivos lista!');
});
</script>
</body>
</html>